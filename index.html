<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eywallah AI | Orion 1</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #00ffff;
      --accent: #00ff8c;
      --background: #0a0a0a;
      --text: #e0e0e0;
      --muted: #b0b0b0;
      --shadow-glow: rgba(0, 255, 255, 0.4);
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--background);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
      min-height: 100vh;
      text-align: center;
    }
    h1 {
      font-size: 3.5em;
      font-weight: 700;
      background: linear-gradient(45deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 15px;
      text-shadow: 0 0 8px var(--shadow-glow);
    }
    #messages {
      width: 90%;
      max-width: 700px;
      height: 480px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      overflow-y: auto;
      text-align: left;
      font-size: 1.1em;
      line-height: 1.5;
    }
    form {
      display: flex;
      width: 90%;
      max-width: 700px;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 0 25px var(--shadow-glow);
    }
    input[type="text"] {
      flex: 1;
      padding: 15px;
      font-size: 1.1em;
      border: none;
      outline: none;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
    }
    button {
      padding: 0 25px;
      background: var(--primary);
      border: none;
      color: #000;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: var(--accent);
    }
    p.user-msg {
      color: var(--primary);
      text-align: right;
      font-weight: 600;
      margin-bottom: 1em;
    }
    p.bot-msg {
      color: var(--accent);
      text-align: left;
      margin-bottom: 1em;
    }
  </style>
</head>
<body>

  <h1>Eywallah AI | Orion 1</h1>

  <div id="messages">
    <p class="bot-msg">ü§ñ Merhaba! Eywallah AI seninle. Sorunu yaz, ben cevaplayayƒ±m.</p>
  </div>

  <form id="input-form">
    <input id="input" type="text" placeholder="Sorunu yaz..." autocomplete="off" />
    <button type="submit">G√∂nder</button>
  </form>

  <script>
    const form = document.getElementById('input-form');
    const input = document.getElementById('input');
    const messagesDiv = document.getElementById('messages');

    let answersData = [];

    // Google Form URL - kendi form ID ve entry numaranƒ± yaz!
    const googleFormURL = "https://docs.google.com/forms/d/e/1FAIpQLScima-8YR6pJqG_60TWPfr2oX39GJRYV7BIYoPLanN1JI0JoQ/formResponse";
    const googleFormEntry = "entry.123456789"; // <-- Bunu Inspect ile formdan al!

    // Bilinmeyen soruyu Google Form'a logla
    function logUnknownQuestionToGoogleForms(question) {
      const formData = new URLSearchParams();
      formData.append(googleFormEntry, question);

      fetch(googleFormURL, {
        method: "POST",
        mode: "no-cors",
        body: formData
      }).then(() => {
        console.log("Soru loglandƒ±.");
      }).catch((err) => {
        console.error("Google Form'a g√∂nderme hatasƒ±:", err);
      });
    }

    // answers.json dosyasƒ±nƒ± y√ºkle
    async function loadAnswers() {
      try {
        const res = await fetch("answers.json");
        const rawData = await res.json();
        answersData = rawData;
        console.log("Cevaplar y√ºklendi.");
      } catch (e) {
        console.error("answers.json y√ºklenemedi:", e);
      }
    }

    function findAnswer(question) {
      const q = question.toLowerCase();
      for (const entry of answersData) {
        for (const keyword of entry.anahtarlar) {
          if (q.includes(keyword.toLowerCase())) {
            const cevaplar = entry.cevaplar;
            return cevaplar[Math.floor(Math.random() * cevaplar.length)];
          }
        }
      }
      return null;
    }

    function addMessage(text, sender = "bot", isHTML = false) {
      const p = document.createElement("p");
      p.className = sender === "user" ? "user-msg" : "bot-msg";
      if (isHTML) {
        p.innerHTML = text;
      } else {
        p.textContent = text;
      }
      messagesDiv.appendChild(p);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const question = input.value.trim();
      if (!question) return;

      addMessage(question, "user");
      input.value = "";
      addMessage("Cevap aranƒ±yor...", "bot");

      if (answersData.length === 0) await loadAnswers();
      const answer = findAnswer(question);

      messagesDiv.lastChild.remove();

      if (answer) {
        addMessage("ü§ñ " + answer, "bot");
      } else {
        addMessage(`ü§ñ Bu soruya ≈üu an cevap veremiyorum.<br>
        <small>üïê <strong>Sadece 1 dakikanƒ± ayƒ±rarak</strong> cevaplanmamƒ±≈ü soruyu <a href="https://docs.google.com/forms/d/e/1FAIpQLScima-8YR6pJqG_60TWPfr2oX39GJRYV7BIYoPLanN1JI0JoQ/viewform" target="_blank" style="color:#00ffff;">bize bildirebilirsin</a>.</small>`, "bot", true);
        logUnknownQuestionToGoogleForms(question);
      }
    });

    loadAnswers();
  </script>

</body>
</html>
